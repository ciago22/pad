# Cargar las librerías necesarias
library(ggplot2)
library(dplyr)
library(tidyr)
library(ggpubr)

# Crear el dataframe con los datos
data <- read.table(text = "
Fecha	Var	tto	rep	H
2024/09/18	MA	T1	1	2
2024/09/18	MA	T1	2	2
2024/09/18	MA	T1	3	2
2024/09/18	MA	T1	4	2
2024/09/18	MA	T1	5	2
2024/09/18	MA	T1	6	2
2024/09/18	MA	T1	7	1
2024/09/18	MA	T1	8	2
2024/09/18	MA	T1	9	2
2024/09/18	MA	T1	10	2
2024/09/18	MA	T1	11	2
2024/09/18	MA	T1	12	2
2024/09/18	MA	T2	1	1
2024/09/18	MA	T2	2	1
2024/09/18	MA	T2	3	1
2024/09/18	MA	T2	4	1
2024/09/18	MA	T2	5	2
2024/09/18	MA	T2	6	2
2024/09/18	MA	T2	7	1
2024/09/18	MA	T2	8	2
2024/09/18	MA	T2	9	2
2024/09/18	MA	T2	10	1
2024/09/18	MA	T2	11	1
2024/09/18	MA	T2	12	1
2024/09/18	MA	T3	1	1
2024/09/18	MA	T3	2	1
2024/09/18	MA	T3	3	1
2024/09/18	MA	T3	4	1
2024/09/18	MA	T3	5	1
2024/09/18	MA	T3	6	1
2024/09/18	MA	T3	7	0
2024/09/18	MA	T3	8	0
2024/09/18	MA	T3	9	1
2024/09/18	MA	T3	10	1
2024/09/18	MA	T3	11	1
2024/09/18	MA	T3	12	1
2024/09/18	MB	T1	1	2
2024/09/18	MB	T1	2	1
2024/09/18	MB	T1	3	2
2024/09/18	MB	T1	4	1
2024/09/18	MB	T1	5	1
2024/09/18	MB	T1	6	2
2024/09/18	MB	T1	7	1
2024/09/18	MB	T1	8	2
2024/09/18	MB	T1	9	1
2024/09/18	MB	T1	10	1
2024/09/18	MB	T1	11	1
2024/09/18	MB	T1	12	1
2024/09/18	MB	T2	1	2
2024/09/18	MB	T2	2	1
2024/09/18	MB	T2	3	1
2024/09/18	MB	T2	4	2
2024/09/18	MB	T2	5	2
2024/09/18	MB	T2	6	1
2024/09/18	MB	T2	7	1
2024/09/18	MB	T2	8	2
2024/09/18	MB	T2	9	2
2024/09/18	MB	T2	10	1
2024/09/18	MB	T2	11	1
2024/09/18	MB	T2	12	2
2024/09/18	MB	T3	1	1
2024/09/18	MB	T3	2	1
2024/09/18	MB	T3	3	1
2024/09/18	MB	T3	4	1
2024/09/18	MB	T3	5	2
2024/09/18	MB	T3	6	1
2024/09/18	MB	T3	7	1
2024/09/18	MB	T3	8	1
2024/09/18	MB	T3	9	2
2024/09/18	MB	T3	10	1
2024/09/18	MB	T3	11	2
2024/09/18	MB	T3	12	2
2024/09/24	MA	T1	1	4
2024/09/24	MA	T1	2	4
2024/09/24	MA	T1	3	4
2024/09/24	MA	T1	4	4
2024/09/24	MA	T1	5	4
2024/09/24	MA	T1	6	4
2024/09/24	MA	T1	7	4
2024/09/24	MA	T1	8	4
2024/09/24	MA	T1	9	5
2024/09/24	MA	T1	10	4
2024/09/24	MA	T1	11	4
2024/09/24	MA	T1	12	4
2024/09/24	MA	T2	1	4
2024/09/24	MA	T2	2	4
2024/09/24	MA	T2	3	3
2024/09/24	MA	T2	4	4
2024/09/24	MA	T2	5	4
2024/09/24	MA	T2	6	4
2024/09/24	MA	T2	7	4
2024/09/24	MA	T2	8	4
2024/09/24	MA	T2	9	4
2024/09/24	MA	T2	10	4
2024/09/24	MA	T2	11	4
2024/09/24	MA	T2	12	4
2024/09/24	MA	T3	1	4
2024/09/24	MA	T3	2	4
2024/09/24	MA	T3	3	4
2024/09/24	MA	T3	4	4
2024/09/24	MA	T3	5	4
2024/09/24	MA	T3	6	4
2024/09/24	MA	T3	7	4
2024/09/24	MA	T3	8	4
2024/09/24	MA	T3	9	4
2024/09/24	MA	T3	10	5
2024/09/24	MA	T3	11	4
2024/09/24	MA	T3	12	3
2024/09/24	MB	T1	1	4
2024/09/24	MB	T1	2	4
2024/09/24	MB	T1	3	3
2024/09/24	MB	T1	4	4
2024/09/24	MB	T1	5	4
2024/09/24	MB	T1	6	4
2024/09/24	MB	T1	7	4
2024/09/24	MB	T1	8	4
2024/09/24	MB	T1	9	4
2024/09/24	MB	T1	10	4
2024/09/24	MB	T1	11	4
2024/09/24	MB	T1	12	4
2024/09/24	MB	T2	1	4
2024/09/24	MB	T2	2	4
2024/09/24	MB	T2	3	4
2024/09/24	MB	T2	4	3
2024/09/24	MB	T2	5	4
2024/09/24	MB	T2	6	4
2024/09/24	MB	T2	7	4
2024/09/24	MB	T2	8	4
2024/09/24	MB	T2	9	4
2024/09/24	MB	T2	10	3
2024/09/24	MB	T2	11	3
2024/09/24	MB	T2	12	3
2024/09/24	MB	T3	1	4
2024/09/24	MB	T3	2	4
2024/09/24	MB	T3	3	4
2024/09/24	MB	T3	4	3
2024/09/24	MB	T3	5	4
2024/09/24	MB	T3	6	4
2024/09/24	MB	T3	7	4
2024/09/24	MB	T3	8	4
2024/09/24	MB	T3	9	4
2024/09/24	MB	T3	10	4
2024/09/24	MB	T3	11	4
2024/09/24	MB	T3	12	4
", header = TRUE, sep = "\t")

# Convert 'H' to numeric
data$H <- as.numeric(data$H)

# ANOVA
anova_result <- aov(H ~ Var * tto, data = data)
summary(anova_result)

# Tukey's Honest Significant Difference test if ANOVA is significant
tukey_result <- TukeyHSD(anova_result)
print(tukey_result)

# Gráfico
ggplot(data, aes(x = interaction(Var, tto), y = H)) +
  geom_boxplot(fill = "lightblue") +
  labs(title = "Número de hojas según el tratamiento y la variedad",
       x = "Variedad y Tratamiento",
       y = "Número de Hojas") +
  theme_minimal() +
  stat_summary(fun = mean, geom = "point", shape = 3, size = 3, color = "red")

