# Cargar las librerías necesarias
library(dplyr)
library(ggplot2)
library(reshape2)
library(multcomp) # Para el análisis de Tukey

# Datos en formato de dataframe
data <- read.table(text = "Fecha Var tto rep D
2024/09/18 MA T1 1 3.45
2024/09/18 MA T1 2 3.21
2024/09/18 MA T1 3 3.80
2024/09/18 MA T1 4 3.15
2024/09/18 MA T1 5 3.79
2024/09/18 MA T1 6 3.06
2024/09/18 MA T1 7 3.58
2024/09/18 MA T1 8 3.93
2024/09/18 MA T1 9 3.51
2024/09/18 MA T1 10 2.67
2024/09/18 MA T1 11 3.61
2024/09/18 MA T1 12 3.23
2024/09/18 MA T2 1 2.89
2024/09/18 MA T2 2 3.21
2024/09/18 MA T2 3 2.75
2024/09/18 MA T2 4 2.95
2024/09/18 MA T2 5 4.28
2024/09/18 MA T2 6 3.41
2024/09/18 MA T2 7 4.17
2024/09/18 MA T2 8 3.27
2024/09/18 MA T2 9 3.45
2024/09/18 MA T2 10 3.67
2024/09/18 MA T2 11 3.79
2024/09/18 MA T2 12 4.08
2024/09/18 MA T3 1 3.80
2024/09/18 MA T3 2 3.40
2024/09/18 MA T3 3 3.60
2024/09/18 MA T3 4 3.36
2024/09/18 MA T3 5 3.29
2024/09/18 MA T3 6 3.05
2024/09/18 MA T3 7 3.71
2024/09/18 MA T3 8 2.37
2024/09/18 MA T3 9 2.28
2024/09/18 MA T3 10 2.43
2024/09/18 MA T3 11 3.63
2024/09/18 MA T3 12 3.49
2024/09/18 MB T1 1 3.27
2024/09/18 MB T1 2 3.27
2024/09/18 MB T1 3 3.16
2024/09/18 MB T1 4 3.62
2024/09/18 MB T1 5 3.54
2024/09/18 MB T1 6 3.08
2024/09/18 MB T1 7 2.62
2024/09/18 MB T1 8 3.60
2024/09/18 MB T1 9 3.57
2024/09/18 MB T1 10 4.50
2024/09/18 MB T1 11 2.82
2024/09/18 MB T1 12 2.34
2024/09/18 MB T2 1 3.71
2024/09/18 MB T2 2 3.26
2024/09/18 MB T2 3 3.68
2024/09/18 MB T2 4 3.54
2024/09/18 MB T2 5 3.34
2024/09/18 MB T2 6 3.25
2024/09/18 MB T2 7 3.24
2024/09/18 MB T2 8 3.34
2024/09/18 MB T2 9 3.07
2024/09/18 MB T2 10 2.75
2024/09/18 MB T2 11 3.57
2024/09/18 MB T2 12 3.45
2024/09/18 MB T3 1 3.29
2024/09/18 MB T3 2 3.30
2024/09/18 MB T3 3 3.14
2024/09/18 MB T3 4 2.39
2024/09/18 MB T3 5 3.26
2024/09/18 MB T3 6 3.20
2024/09/18 MB T3 7 3.69
2024/09/18 MB T3 8 3.78
2024/09/18 MB T3 9 3.17
2024/09/18 MB T3 10 2.52
2024/09/18 MB T3 11 2.36
2024/09/18 MB T3 12 2.66
2024/09/24 MA T1 1 3.58
2024/09/24 MA T1 2 3.46
2024/09/24 MA T1 3 3.50
2024/09/24 MA T1 4 3.80
2024/09/24 MA T1 5 3.90
2024/09/24 MA T1 6 3.73
2024/09/24 MA T1 7 3.75
2024/09/24 MA T1 8 3.19
2024/09/24 MA T1 9 3.66
2024/09/24 MA T1 10 3.75
2024/09/24 MA T1 11 3.45
2024/09/24 MA T1 12 3.63
2024/09/24 MA T2 1 3.16
2024/09/24 MA T2 2 3.61
2024/09/24 MA T2 3 3.66
2024/09/24 MA T2 4 2.16
2024/09/24 MA T2 5 2.94
2024/09/24 MA T2 6 3.48
2024/09/24 MA T2 7 3.70
2024/09/24 MA T2 8 3.80
2024/09/24 MA T2 9 3.26
2024/09/24 MA T2 10 2.36
2024/09/24 MA T2 11 3.34
2024/09/24 MA T2 12 2.39
2024/09/24 MA T3 1 3.18
2024/09/24 MA T3 2 3.49
2024/09/24 MA T3 3 3.49
2024/09/24 MA T3 4 4.40
2024/09/24 MA T3 5 2.38
2024/09/24 MA T3 6 1.75
2024/09/24 MA T3 7 2.65
2024/09/24 MA T3 8 2.52
2024/09/24 MA T3 9 3.66
2024/09/24 MA T3 10 4.76
2024/09/24 MA T3 11 2.78
2024/09/24 MA T3 12 2.33
2024/09/24 MB T1 1 3.26
2024/09/24 MB T1 2 2.78
2024/09/24 MB T1 3 2.80
2024/09/24 MB T1 4 3.85
2024/09/24 MB T1 5 3.09
2024/09/24 MB T1 6 3.12
2024/09/24 MB T1 7 3.73
2024/09/24 MB T1 8 3.53
2024/09/24 MB T1 9 3.53
2024/09/24 MB T1 10 3.70
2024/09/24 MB T1 11 3.64
2024/09/24 MB T1 12 4.34
2024/09/24 MB T2 1 3.75
2024/09/24 MB T2 2 2.80
2024/09/24 MB T2 3 3.12
2024/09/24 MB T2 4 2.78
2024/09/24 MB T2 5 3.49
2024/09/24 MB T2 6 3.35
2024/09/24 MB T2 7 3.76
2024/09/24 MB T2 8 2.98
2024/09/24 MB T2 9 2.70
2024/09/24 MB T2 10 3.25
2024/09/24 MB T2 11 3.20
2024/09/24 MB T2 12 3.54
2024/09/24 MB T3 1 3.50
2024/09/24 MB T3 2 3.37
2024/09/24 MB T3 3 3.38
2024/09/24 MB T3 4 3.26
2024/09/24 MB T3 5 3.55
2024/09/24 MB T3 6 2.75
2024/09/24 MB T3 7 2.93
2024/09/24 MB T3 8 3.21
2024/09/24 MB T3 9 3.27
2024/09/24 MB T3 10 3.73
2024/09/24 MB T3 11 3.77
2024/09/24 MB T3 12 3.64", header = TRUE)

# Realizar ANOVA
anova_result <- aov(D ~ Var * tto, data = data)
summary(anova_result)

# Verificar si hay diferencias significativas
if (summary(anova_result)[[1]][["Pr(>F)"]][1] < 0.05) {
  cat("Diferencias significativas encontradas. Realizando el test post hoc de Tukey...\n")
  
  # Análisis post hoc de Tukey
  tukey_result <- TukeyHSD(anova_result)
  print(tukey_result)
} else {
  cat("No se encontraron diferencias significativas.\n")
}

# Gráfico de interacción
ggplot(data, aes(x = Var, y = D, color = tto)) +
  geom_point() +
  geom_line(aes(group = tto)) +
  labs(title = "Interacción entre Variedades y Tratamientos",
       x = "Variedad",
       y = "Diámetro") +
  theme_minimal()

